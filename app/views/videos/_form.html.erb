<div id="upload_a_video">
  <h2>Upload A Video</h2>

  <% form_tag "http://s3.amazonaws.com/ankoder_upload", :method => "post", :enctype => "multipart/form-data" do %>
    <%= hidden_field_tag 'AWSAccessKeyId', '04WAVZJW4HAZZQTWKCR2' %>
    <%= hidden_field_tag 'acl', 'public-read' %>
    <%= hidden_field_tag 'Filename', '5_df.jpg' %>
    <%= hidden_field_tag 'key', 'uploads/${filename}' %>
    <%= hidden_field_tag 'policy', @policy_base64 %>
    <%= hidden_field_tag 'success_action_redirect', 'http://www.google.com' %>
    <%= hidden_field_tag 'signature', @signature %>
    <p>
    <label for="file">File:</label>
    <%= file_field_tag "file" %>
    </p>
    <%= submit_tag "Upload" %>
  <% end %>

  <div>
    <form id="form1" action="/" method="post" enctype="multipart/form-data">
      <fieldset class="flash" id="fsUploadProgress">
      <legend>Upload Queue</legend>
      </fieldset>                                                

      <div id="divStatus">0 Files Uploaded</div>                         
      <div>   
        <input type="button" value="Upload file (Max 100 MB)" onclick="swfu.selectFiles()" style="font-size: 8pt;" />
        <input id="btnCancel" type="button" value="Cancel All Uploads" onclick="swfu.cancelQueue();" disabled="disabled" style="font-size: 8pt;" />
      </div>
    </form>
  </div>

  <div class="clear"></div>
</div>

<% javascript_tag do %>
  var swfu;

  window.onload = function() {
    swfu = new SWFUpload({
      // Backend Settings
      upload_url : "http://s3.amazonaws.com/ankoder_upload",
//      upload_url : "/profiles/1-jan/photos",
      file_post_name : 'file',
      post_params: {"AWSAccessKeyId" : "04WAVZJW4HAZZQTWKCR2",
                    "acl" : "public-read",
                    "key" : "uploads/${filename}",
                    "policy" : "<%= @policy_base64 %>",
                    "signature" : "<%= @signature %>",
                   },
      flash_url : "/resources/swfupload_f9.swf",

      // File Upload Settings
      file_size_limit : "1024000", //1000MB
      file_types : "*.jpg;*.wmv",
      file_types_description : "video files only",
      file_upload_limit : "3",
      file_queue_limit : "3",

      custom_settings : {
        progressTarget : "fsUploadProgress",
        cancelButtonId : "btnCancel"
      },

      // The event handler functions are defined in handlers.js
      file_queued_handler : fileQueued,
      file_queue_error_handler : fileQueueError,
      file_dialog_complete_handler : fileDialogComplete,
      upload_start_handler : uploadStart,
      upload_progress_handler : uploadProgress,
      upload_error_handler : uploadError,
      upload_success_handler : uploadSuccess,
      upload_complete_handler : uploadComplete,
      queue_complete_handler : queueComplete,  // Queue plugin event

      // UI Settings
//      ui_container_id : flashUIElement,
//      degraded_container_id : fileUIElement,

      // Debug Settings
      debug: true,
//      debug_handler: swfDebug
    });
  };



//upload.customSettings.progressTarget = "fsUploadProgress_"+index; // Add an additional setting that will later be used by the handler.
//
//upload.customSettings.cancelButtonId = "btnCancel"+index; // Add an additional setting that will later be used by the handler.
//btnSelect = document.getElementById("btnSelect");
//
//btnCancel = document.getElementById("btnCancel");
//YE.addListener(btnSelect, "click", upload.selectFiles, upload, true);
//YE.addListener(btnCancel, "click", upload.cancelQueue, upload, true);
//document.getElementById(fileUIElement).style.display = "none";
//document.getElementById(flashUIElement).style.display = "block";
//};
//YE.onDOMReady(init);
<% end %>
